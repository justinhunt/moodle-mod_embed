/**
 * JavaScript library for the mod_embed module.
 *
 * @package    mod
 * @subpackage mod_embed
 * @copyright  2014 Justin Hunt  {@link http://poodll.com}
 * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later
 */
define("mod_embed/module",["jquery","core/log"],(function($,log){return log.debug("Mod Embed main module : initialising"),{complete:function(id,o,args){var returndata=o.responseText,Y=M.mod_embed.jscomplete.Y;Y.JSON.parse(returndata).success&&(M.mod_embed.jscomplete.iscomplete=!0,M.mod_embed.timer.iscomplete=!0,M.mod_embed.timer.showcompletion&&Y.one("#embed-completed").setStyle("display","block"))},docomplete:function(){if(!M.mod_embed.jscomplete.iscomplete){var Y=M.mod_embed.jscomplete.Y,uri="ajaxcomplete.php?id="+M.mod_embed.jscomplete.cmid+"&sesskey="+M.cfg.sesskey;Y.on("io:complete",M.mod_embed.jscomplete.complete,Y,null),Y.io(uri)}},thetimer:{iscomplete:!0,endtime:0,timeoutid:null,init:function(Y,start,cmid,showcompletion,iscomplete){start>0&&!iscomplete?this.update():iscomplete&&showcompletion&&$("#embed-completed").show()},stop:function(e){timeoutid&&clearTimeout(timeoutid)},two_digit:function(num){return num<10?"0"+num:num},complete:function(id,o,args){var returndata=o.responseText;$("#embed-timer").hide(),JSON.parse(returndata).success&&(this.iscomplete=!0,this.showcompletion&&$("#embed-completed").show())},update:function(){var secondsleft=Math.floor((this.endtime-(new Date).getTime())/1e3);if(secondsleft<0){this.stop(null);var uri="ajaxcomplete.php?id="+M.mod_embed.timer.cmid+"&sesskey="+M.cfg.sesskey;return Y.on("io:complete",this.complete,Y,null),void Y.io(uri)}secondsleft<100&&$("#embed-timer").removeClass("timeleft"+(secondsleft+2)).removeClass("timeleft"+(secondsleft+1)).addClass("timeleft"+secondsleft);var hours=Math.floor(secondsleft/3600);secondsleft-=3600*hours;var minutes=Math.floor(secondsleft/60),seconds=secondsleft-=60*minutes;$("#embed-time-left").text(hours+":"+M.mod_embed.timer.two_digit(minutes)+":"+M.mod_embed.timer.two_digit(seconds)),this.timeoutid=setTimeout(M.mod_embed.timer.update,100)}}}}));

//# sourceMappingURL=module.min.js.map